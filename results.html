<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oscar Results 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #C5A572;
            --gold-dark: #A8894D;
            --gold-light: #E8D5B0;
            --black: #1A1A1A;
            --white: #FFFFFF;
            --gray-50: #FAFAFA;
            --gray-100: #F5F5F5;
            --gray-200: #E5E5E5;
            --gray-300: #D4D4D4;
            --gray-400: #A3A3A3;
            --gray-600: #525252;
            --gray-800: #262626;
            --success: #16A34A;
            --error: #DC2626;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--white);
            color: var(--black);
            line-height: 1.6;
        }

        .header {
            background: var(--black);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .oscar-icon {
            width: 40px;
            height: 40px;
        }

        .logo-text {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gold);
        }

        .logo-year {
            font-size: 0.75rem;
            color: var(--gray-400);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--gold);
            color: var(--black);
        }

        .btn-primary:hover {
            background: var(--gold-dark);
        }

        .btn-outline {
            background: transparent;
            border: 1.5px solid var(--gold);
            color: var(--gold);
        }

        .btn-outline:hover {
            background: var(--gold);
            color: var(--black);
        }

        .btn-admin {
            background: var(--error);
            color: white;
        }

        .btn-admin.active {
            background: var(--success);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: var(--gray-400);
            font-size: 1.1rem;
        }

        .admin-bar {
            background: var(--gray-800);
            color: var(--white);
            padding: 16px 24px;
            border-radius: 10px;
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .admin-bar.hidden {
            display: none;
        }

        .admin-status {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .admin-actions {
            display: flex;
            gap: 12px;
        }

        /* Import Section */
        .import-section {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .import-section h3 {
            font-family: 'Playfair Display', serif;
            margin-bottom: 16px;
        }

        .import-row {
            display: flex;
            gap: 12px;
        }

        .import-row input {
            flex: 1;
            padding: 12px 16px;
            border: 1.5px solid var(--gray-300);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
        }

        .import-row input:focus {
            outline: none;
            border-color: var(--gold);
        }

        /* Leaderboard */
        .leaderboard {
            margin-bottom: 48px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--black);
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard-table th {
            text-align: left;
            padding: 16px;
            background: var(--gray-50);
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--gray-600);
            border-bottom: 2px solid var(--gray-200);
        }

        .leaderboard-table td {
            padding: 16px;
            border-bottom: 1px solid var(--gray-200);
        }

        .leaderboard-table tr:hover {
            background: var(--gray-50);
        }

        .rank {
            font-family: 'Playfair Display', serif;
            font-size: 1.25rem;
            font-weight: 600;
            width: 60px;
        }

        .rank-1 { color: #FFD700; }
        .rank-2 { color: #C0C0C0; }
        .rank-3 { color: #CD7F32; }

        .player-name {
            font-weight: 500;
        }

        .score {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gold-dark);
        }

        .score-breakdown {
            font-size: 0.8rem;
            color: var(--gray-400);
        }

        .correct-count {
            color: var(--success);
        }

        .penalty-count {
            color: var(--error);
        }

        .no-participants {
            text-align: center;
            padding: 48px;
            color: var(--gray-400);
        }

        /* Winners Section */
        .winners-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .winner-card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            overflow: hidden;
        }

        .winner-card.main-category {
            border-left: 4px solid var(--gold);
        }

        .winner-card-header {
            padding: 16px 20px;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .winner-card-title {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }

        .winner-badge {
            font-size: 0.7rem;
            padding: 4px 10px;
            background: var(--gold);
            color: var(--black);
            border-radius: 20px;
            font-weight: 600;
        }

        .winner-card-body {
            padding: 16px 20px;
        }

        .winner-display {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: linear-gradient(135deg, #FFFBF0 0%, #FFF8E7 100%);
            border: 1.5px solid var(--gold);
            border-radius: 8px;
        }

        .winner-icon {
            width: 24px;
            height: 24px;
            color: var(--gold);
        }

        .winner-name {
            font-weight: 600;
        }

        .winner-film {
            font-size: 0.875rem;
            color: var(--gray-400);
        }

        .no-winner {
            color: var(--gray-400);
            font-style: italic;
            padding: 12px 16px;
            background: var(--gray-50);
            border-radius: 8px;
            text-align: center;
        }

        /* Admin Select */
        .admin-select {
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid var(--gray-300);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            background: var(--white);
            cursor: pointer;
        }

        .admin-select:focus {
            outline: none;
            border-color: var(--gold);
        }

        .admin-select.has-winner {
            background: linear-gradient(135deg, #FFFBF0 0%, #FFF8E7 100%);
            border-color: var(--gold);
        }

        /* Comparison View */
        .comparison-toggle {
            margin-bottom: 24px;
        }

        .toggle-btn {
            padding: 8px 16px;
            border: 1.5px solid var(--gray-300);
            background: var(--white);
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .toggle-btn:first-child {
            border-radius: 8px 0 0 8px;
        }

        .toggle-btn:last-child {
            border-radius: 0 8px 8px 0;
            border-left: none;
        }

        .toggle-btn.active {
            background: var(--black);
            color: var(--white);
            border-color: var(--black);
        }

        .picks-grid {
            display: none;
            overflow-x: auto;
        }

        .picks-grid.active {
            display: block;
        }

        .picks-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .picks-table th, .picks-table td {
            padding: 12px;
            border: 1px solid var(--gray-200);
            text-align: left;
        }

        .picks-table th {
            background: var(--gray-50);
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .picks-table .correct {
            background: #DCFCE7;
            color: var(--success);
        }

        .picks-table .incorrect {
            background: #FEE2E2;
            color: var(--error);
        }

        .picks-table .pending {
            background: var(--white);
        }

        .footer {
            text-align: center;
            padding: 40px 24px;
            color: var(--gray-400);
            font-size: 0.875rem;
            border-top: 1px solid var(--gray-200);
            margin-top: 48px;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 16px;
            }

            .admin-bar {
                flex-direction: column;
                text-align: center;
            }

            .import-row {
                flex-direction: column;
            }

            .winners-section {
                grid-template-columns: 1fr;
            }

            .page-title {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg class="oscar-icon" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <ellipse cx="20" cy="8" rx="6" ry="7" fill="#C5A572"/>
                    <path d="M14 14C14 14 13 18 13 22C13 26 14 32 14 32L20 36L26 32C26 32 27 26 27 22C27 18 26 14 26 14" fill="#C5A572"/>
                    <ellipse cx="20" cy="14" rx="5" ry="2" fill="#A8894D"/>
                    <rect x="16" y="32" width="8" height="4" fill="#C5A572"/>
                    <rect x="14" y="36" width="12" height="3" rx="1" fill="#C5A572"/>
                </svg>
                <div>
                    <div class="logo-text">Live Results</div>
                    <div class="logo-year">98th Academy Awards</div>
                </div>
            </div>
            <div class="header-actions">
                <a href="index.html" class="btn btn-outline">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"/>
                    </svg>
                    Back to Ballot
                </a>
                <button class="btn btn-admin" id="adminToggle" onclick="toggleAdminMode()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                    <span id="adminToggleText">Enter Admin Mode</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="page-header">
            <h1 class="page-title">Live Leaderboard</h1>
            <p class="page-subtitle" id="winnersCount">0 of 24 winners announced</p>
        </div>

        <div class="admin-bar hidden" id="adminBar">
            <div class="admin-status">
                <span class="status-dot"></span>
                <span>Admin Mode Active - Select winners as they're announced</span>
            </div>
            <div class="admin-actions">
                <button class="btn btn-outline" onclick="clearAllWinners()">Clear All Winners</button>
            </div>
        </div>

        <div class="import-section">
            <h3>Import Ballot</h3>
            <p style="color: var(--gray-400); margin-bottom: 12px; font-size: 0.875rem;">
                Paste a ballot code from a friend to add them to the leaderboard
            </p>
            <div class="import-row">
                <input type="text" id="importCode" placeholder="Paste ballot code here...">
                <button class="btn btn-primary" onclick="importBallot()">Import</button>
            </div>
        </div>

        <section class="leaderboard">
            <div class="section-header">
                <h2 class="section-title">Standings</h2>
                <span id="participantCount">0 participants</span>
            </div>
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Name</th>
                        <th>Correct</th>
                        <th>Penalty</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody id="leaderboardBody">
                </tbody>
            </table>
            <div class="no-participants" id="noParticipants">
                No ballots imported yet. Import ballots using the form above.
            </div>
        </section>

        <div class="comparison-toggle">
            <button class="toggle-btn active" onclick="showView('winners')">Winners</button>
            <button class="toggle-btn" onclick="showView('comparison')">Compare Picks</button>
        </div>

        <section id="winnersView" class="winners-section">
        </section>

        <section id="comparisonView" class="picks-grid">
        </section>
    </main>

    <footer class="footer">
        <p>98th Academy Awards &bull; Sunday, March 15, 2026 &bull; Hosted by Conan O'Brien</p>
    </footer>

    <script>
        const BEST_PICTURE_FILMS = [
            "Bugonia", "F1", "Frankenstein", "Hamnet", "Marty Supreme",
            "One Battle After Another", "The Secret Agent", "Sentimental Value", "Sinners", "Train Dreams"
        ];

        const MAIN_CATEGORIES = [
            "Best Picture", "Directing", "Actor in a Leading Role", "Actress in a Leading Role",
            "Actor in a Supporting Role", "Actress in a Supporting Role",
            "Writing (Original Screenplay)", "Writing (Adapted Screenplay)"
        ];

        const CATEGORIES = {
            "Best Picture": [
                { name: "Bugonia" }, { name: "F1" }, { name: "Frankenstein" }, { name: "Hamnet" },
                { name: "Marty Supreme" }, { name: "One Battle After Another" }, { name: "The Secret Agent" },
                { name: "Sentimental Value" }, { name: "Sinners" }, { name: "Train Dreams" }
            ],
            "Directing": [
                { name: "Chloé Zhao", film: "Hamnet" }, { name: "Josh Safdie", film: "Marty Supreme" },
                { name: "Paul Thomas Anderson", film: "One Battle After Another" },
                { name: "Joachim Trier", film: "Sentimental Value" }, { name: "Ryan Coogler", film: "Sinners" }
            ],
            "Actor in a Leading Role": [
                { name: "Timothée Chalamet", film: "Marty Supreme" }, { name: "Leonardo DiCaprio", film: "One Battle After Another" },
                { name: "Ethan Hawke", film: "Blue Moon" }, { name: "Michael B. Jordan", film: "Sinners" },
                { name: "Wagner Moura", film: "The Secret Agent" }
            ],
            "Actress in a Leading Role": [
                { name: "Jessie Buckley", film: "Hamnet" }, { name: "Rose Byrne", film: "If I Had Legs I'd Kick You" },
                { name: "Kate Hudson", film: "Song Sung Blue" }, { name: "Renate Reinsve", film: "Sentimental Value" },
                { name: "Emma Stone", film: "Bugonia" }
            ],
            "Actor in a Supporting Role": [
                { name: "Benicio del Toro", film: "One Battle After Another" }, { name: "Jacob Elordi", film: "Frankenstein" },
                { name: "Delroy Lindo", film: "Sinners" }, { name: "Sean Penn", film: "One Battle After Another" },
                { name: "Stellan Skarsgård", film: "Sentimental Value" }
            ],
            "Actress in a Supporting Role": [
                { name: "Elle Fanning", film: "Sentimental Value" }, { name: "Inga Ibsdotter Lilleaas", film: "Sentimental Value" },
                { name: "Amy Madigan", film: "Weapons" }, { name: "Wunmi Mosaku", film: "Sinners" },
                { name: "Teyana Taylor", film: "One Battle After Another" }
            ],
            "Writing (Original Screenplay)": [
                { name: "Robert Kaplow", film: "Blue Moon" }, { name: "Jafar Panahi", film: "It Was Just an Accident" },
                { name: "Ronald Bronstein & Josh Safdie", film: "Marty Supreme" },
                { name: "Eskil Vogt & Joachim Trier", film: "Sentimental Value" }, { name: "Ryan Coogler", film: "Sinners" }
            ],
            "Writing (Adapted Screenplay)": [
                { name: "Will Tracy", film: "Bugonia" }, { name: "Guillermo del Toro", film: "Frankenstein" },
                { name: "Chloé Zhao & Maggie O'Farrell", film: "Hamnet" }, { name: "Paul Thomas Anderson", film: "One Battle After Another" },
                { name: "Clint Bentley & Greg Kwedar", film: "Train Dreams" }
            ],
            "Animated Feature Film": [
                { name: "Arco" }, { name: "Elio" }, { name: "KPop Demon Hunters" },
                { name: "Little Amélie or the Character of Rain" }, { name: "Zootopia 2" }
            ],
            "Animated Short Film": [
                { name: "Butterfly" }, { name: "Forevergreen" }, { name: "The Girl Who Cried Pearls" },
                { name: "Retirement Plan" }, { name: "The Three Sisters" }
            ],
            "Cinematography": [
                { name: "Frankenstein" }, { name: "Marty Supreme" }, { name: "One Battle After Another" },
                { name: "Sinners" }, { name: "Train Dreams" }
            ],
            "Costume Design": [
                { name: "Avatar: Fire and Ash" }, { name: "Frankenstein" }, { name: "Hamnet" },
                { name: "Marty Supreme" }, { name: "Sinners" }
            ],
            "Documentary Feature Film": [
                { name: "The Alabama Solution" }, { name: "Come See Me in the Good Light" },
                { name: "Cutting Through Rocks" }, { name: "Mr. Nobody Against Putin" }, { name: "The Perfect Neighbor" }
            ],
            "Documentary Short Film": [
                { name: "All the Empty Rooms" }, { name: "Armed Only With a Camera" }, { name: "Children No More" },
                { name: "The Devil Is Busy" }, { name: "Perfectly a Strangeness" }
            ],
            "Film Editing": [
                { name: "F1" }, { name: "Marty Supreme" }, { name: "One Battle After Another" },
                { name: "Sentimental Value" }, { name: "Sinners" }
            ],
            "International Feature Film": [
                { name: "The Secret Agent", film: "Brazil" }, { name: "It Was Just an Accident", film: "France" },
                { name: "Sentimental Value", film: "Norway" }, { name: "Sirāt", film: "Spain" },
                { name: "The Voice of Hind Rajab", film: "Tunisia" }
            ],
            "Casting": [
                { name: "Nina Gold", film: "Hamnet" }, { name: "Jennifer Venditti", film: "Marty Supreme" },
                { name: "Cassandra Kulukundis", film: "One Battle After Another" },
                { name: "Gabriel Domingues", film: "The Secret Agent" }, { name: "Francine Maisler", film: "Sinners" }
            ],
            "Makeup and Hairstyling": [
                { name: "Frankenstein" }, { name: "Kokuho" }, { name: "Sinners" },
                { name: "The Smashing Machine" }, { name: "The Ugly Stepsister" }
            ],
            "Music (Original Score)": [
                { name: "Jerskin Fendrix", film: "Bugonia" }, { name: "Alexandre Desplat", film: "Frankenstein" },
                { name: "Max Richter", film: "Hamnet" }, { name: "Jonny Greenwood", film: "One Battle After Another" },
                { name: "Ludwig Goransson", film: "Sinners" }
            ],
            "Music (Original Song)": [
                { name: '"Dear Me"', film: "Diane Warren: Relentless" }, { name: '"Golden"', film: "KPop Demon Hunters" },
                { name: '"I Lied to You"', film: "Sinners" }, { name: '"Sweet Dreams of Joy"', film: "Viva Verdi!" },
                { name: '"Train Dreams"', film: "Train Dreams" }
            ],
            "Production Design": [
                { name: "Frankenstein" }, { name: "Hamnet" }, { name: "Marty Supreme" },
                { name: "One Battle After Another" }, { name: "Sinners" }
            ],
            "Live Action Short Film": [
                { name: "Butcher's Stain" }, { name: "A Friend of Dorothy" }, { name: "Jane Austen's Period Drama" },
                { name: "The Singers" }, { name: "Two People Exchanging Saliva" }
            ],
            "Sound": [
                { name: "F1" }, { name: "Frankenstein" }, { name: "One Battle After Another" },
                { name: "Sinners" }, { name: "Sirāt" }
            ],
            "Visual Effects": [
                { name: "Avatar: Fire and Ash" }, { name: "F1" }, { name: "Jurassic World Rebirth" },
                { name: "The Lost Bus" }, { name: "Sinners" }
            ]
        };

        let adminMode = false;
        let participants = [];
        let winners = {};

        function loadData() {
            const savedParticipants = localStorage.getItem('oscarParticipants2026');
            if (savedParticipants) {
                participants = JSON.parse(savedParticipants);
            }

            const savedWinners = localStorage.getItem('oscarWinners2026');
            if (savedWinners) {
                winners = JSON.parse(savedWinners);
            }

            // Also add local user's ballot if exists
            const localBallot = localStorage.getItem('oscarBallot2026');
            if (localBallot) {
                const local = JSON.parse(localBallot);
                if (local.userName && Object.keys(local.picks).length > 0) {
                    const exists = participants.find(p => p.name === local.userName);
                    if (!exists) {
                        participants.push({
                            name: local.userName,
                            filmsSeen: local.filmsSeen || [],
                            picks: local.picks
                        });
                        saveParticipants();
                    } else {
                        // Update existing
                        exists.filmsSeen = local.filmsSeen || [];
                        exists.picks = local.picks;
                        saveParticipants();
                    }
                }
            }
        }

        function saveParticipants() {
            localStorage.setItem('oscarParticipants2026', JSON.stringify(participants));
        }

        function saveWinners() {
            localStorage.setItem('oscarWinners2026', JSON.stringify(winners));
        }

        function toggleAdminMode() {
            adminMode = !adminMode;
            const btn = document.getElementById('adminToggle');
            const text = document.getElementById('adminToggleText');
            const bar = document.getElementById('adminBar');

            if (adminMode) {
                btn.classList.add('active');
                text.textContent = 'Exit Admin Mode';
                bar.classList.remove('hidden');
            } else {
                btn.classList.remove('active');
                text.textContent = 'Enter Admin Mode';
                bar.classList.add('hidden');
            }

            renderWinners();
        }

        function importBallot() {
            const input = document.getElementById('importCode');
            const code = input.value.trim();

            if (!code) {
                alert('Please paste a ballot code');
                return;
            }

            try {
                const data = JSON.parse(atob(code));
                if (!data.name || !data.picks) {
                    throw new Error('Invalid ballot format');
                }

                const exists = participants.findIndex(p => p.name === data.name);
                if (exists >= 0) {
                    participants[exists] = {
                        name: data.name,
                        filmsSeen: data.filmsSeen || [],
                        picks: data.picks
                    };
                } else {
                    participants.push({
                        name: data.name,
                        filmsSeen: data.filmsSeen || [],
                        picks: data.picks
                    });
                }

                saveParticipants();
                input.value = '';
                renderAll();
                alert(`${data.name}'s ballot imported successfully!`);
            } catch (e) {
                alert('Invalid ballot code. Please check and try again.');
            }
        }

        function calculateScore(participant) {
            const filmsNotSeen = BEST_PICTURE_FILMS.length - (participant.filmsSeen?.length || 0);
            let correctPicks = 0;
            let score = -filmsNotSeen;

            Object.entries(winners).forEach(([category, winner]) => {
                if (participant.picks[category] === winner) {
                    const points = MAIN_CATEGORIES.includes(category) ? 2 : 1;
                    score += points;
                    correctPicks++;
                }
            });

            return { score, correctPicks, penalty: filmsNotSeen };
        }

        function renderLeaderboard() {
            const tbody = document.getElementById('leaderboardBody');
            const noParticipants = document.getElementById('noParticipants');
            const countEl = document.getElementById('participantCount');

            if (participants.length === 0) {
                tbody.innerHTML = '';
                noParticipants.style.display = 'block';
                countEl.textContent = '0 participants';
                return;
            }

            noParticipants.style.display = 'none';
            countEl.textContent = `${participants.length} participant${participants.length !== 1 ? 's' : ''}`;

            const scored = participants.map(p => ({
                ...p,
                ...calculateScore(p)
            })).sort((a, b) => b.score - a.score);

            tbody.innerHTML = scored.map((p, idx) => {
                const rank = idx + 1;
                const rankClass = rank <= 3 ? `rank-${rank}` : '';
                return `
                    <tr>
                        <td class="rank ${rankClass}">#${rank}</td>
                        <td class="player-name">${p.name}</td>
                        <td class="correct-count">${p.correctPicks}/${Object.keys(winners).length}</td>
                        <td class="penalty-count">-${p.penalty}</td>
                        <td class="score">${p.score}</td>
                    </tr>
                `;
            }).join('');
        }

        function renderWinners() {
            const section = document.getElementById('winnersView');
            const winnersCount = Object.keys(winners).length;
            document.getElementById('winnersCount').textContent = `${winnersCount} of 24 winners announced`;

            section.innerHTML = Object.entries(CATEGORIES).map(([category, nominees]) => {
                const isMain = MAIN_CATEGORIES.includes(category);
                const winner = winners[category];
                const winnerData = nominees.find(n => n.name === winner);

                if (adminMode) {
                    return `
                        <div class="winner-card ${isMain ? 'main-category' : ''}">
                            <div class="winner-card-header">
                                <span class="winner-card-title">${category}</span>
                                ${isMain ? '<span class="winner-badge">2 PTS</span>' : ''}
                            </div>
                            <div class="winner-card-body">
                                <select class="admin-select ${winner ? 'has-winner' : ''}" onchange="setWinner('${category}', this.value)">
                                    <option value="">-- Select Winner --</option>
                                    ${nominees.map(n => `
                                        <option value="${n.name}" ${winner === n.name ? 'selected' : ''}>
                                            ${n.name}${n.film ? ` (${n.film})` : ''}
                                        </option>
                                    `).join('')}
                                </select>
                            </div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="winner-card ${isMain ? 'main-category' : ''}">
                            <div class="winner-card-header">
                                <span class="winner-card-title">${category}</span>
                                ${isMain ? '<span class="winner-badge">2 PTS</span>' : ''}
                            </div>
                            <div class="winner-card-body">
                                ${winner ? `
                                    <div class="winner-display">
                                        <svg class="winner-icon" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                                        </svg>
                                        <div>
                                            <div class="winner-name">${winner}</div>
                                            ${winnerData?.film ? `<div class="winner-film">${winnerData.film}</div>` : ''}
                                        </div>
                                    </div>
                                ` : `
                                    <div class="no-winner">Not yet announced</div>
                                `}
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }

        function renderComparison() {
            const section = document.getElementById('comparisonView');

            if (participants.length === 0) {
                section.innerHTML = '<p class="no-participants">No participants to compare.</p>';
                return;
            }

            const categories = Object.keys(CATEGORIES);

            let html = `
                <table class="picks-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Winner</th>
                            ${participants.map(p => `<th>${p.name}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
            `;

            categories.forEach(category => {
                const winner = winners[category];
                html += `
                    <tr>
                        <td><strong>${category}</strong></td>
                        <td>${winner || '-'}</td>
                        ${participants.map(p => {
                            const pick = p.picks[category] || '-';
                            let cellClass = 'pending';
                            if (winner) {
                                cellClass = pick === winner ? 'correct' : 'incorrect';
                            }
                            return `<td class="${cellClass}">${pick}</td>`;
                        }).join('')}
                    </tr>
                `;
            });

            html += '</tbody></table>';
            section.innerHTML = html;
        }

        function setWinner(category, winner) {
            if (winner) {
                winners[category] = winner;
            } else {
                delete winners[category];
            }
            saveWinners();
            renderAll();
        }

        function clearAllWinners() {
            if (confirm('Are you sure you want to clear all winners?')) {
                winners = {};
                saveWinners();
                renderAll();
            }
        }

        function showView(view) {
            const btns = document.querySelectorAll('.toggle-btn');
            btns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('winnersView').style.display = view === 'winners' ? 'grid' : 'none';
            document.getElementById('comparisonView').classList.toggle('active', view === 'comparison');
        }

        function renderAll() {
            renderLeaderboard();
            renderWinners();
            renderComparison();
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderAll();
        });
    </script>
</body>
</html>
